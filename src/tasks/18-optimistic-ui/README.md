# Задача 18 — Оптимистичное обновление и откат ошибок

**Уровень:** средний

## Цель

Сделать список элементов с оптимистичными обновлениями: UI меняется сразу, а при ошибке — корректно откатывается и показывает пользователю причину.

## Требования

- Список элементов (например, задачи или посты) с полями `id`, `title`, `likes`.
- Действия:
  - добавление элемента;
  - лайк/анлайк элемента.
- Запросы имитировать через `setTimeout` с задержкой 400–1200 мс и случайной ошибкой (например, 20–30%).
- Оптимистичное обновление:
  - UI обновляется мгновенно;
  - показывается состояние “pending” у элемента или действия (спиннер/иконка/disabled).
- Ошибки:
  - при ошибке происходит откат оптимистичного изменения;
  - показать сообщение об ошибке (toast/inline).
- Конкурентность:
  - если пользователь быстро нажал лайк несколько раз, корректно обработать порядок ответов;
  - при получении ответа на устаревший запрос результат не должен ломать актуальное состояние.
- Очистка:
  - отменить/игнорировать результат запросов при размонтировании.

## Подсказки

- Храни оптимистичную версию данных отдельно от подтверждённой (или используй метки “pending”).
- Для защиты от устаревших ответов используй `requestId`/`version` и проверяй его перед применением результата.
- Можно сделать общий helper `fakeApi` с рандомной ошибкой.

## Критерии приёмки

- UI реагирует мгновенно без ожидания ответа.
- При ошибке состояние корректно откатывается и отображается уведомление.
- Быстрые повторные клики не приводят к “скачкам” состояния.
