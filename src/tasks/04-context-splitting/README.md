# Задача 04 — Разделение контекста и подписка на часть состояния

**Уровень:** продвинутый

## Цель

Вместо одного большого контекста — несколько маленьких. Реализовать подписку на часть состояния (подход в духе «селектор» или `useContextSelector`), чтобы компонент ре-рендерился только при изменении выбранного поля, а не при любом изменении контекста.

## Требования

- Имитация хранилища: пользователь (name, avatar), тема (theme), локаль (locale), корзина (items).
- Разбить на 2–3 контекста (например: UserContext, UIContext, CartContext), чтобы обновление корзины не ре-рендерило компоненты, подписанные только на пользователя.
- Реализовать хук вида `useContextSelector(Context, selector)`, который подписывает компонент только на выбранное значение: при изменении других полей в том же контексте ре-рендера не должно быть.
- Продемонстрировать: один компонент подписан на `user.name`, другой на `cart.items.length`; при добавлении в корзину ре-рендерится только второй.

## Подсказки

- `useContextSelector`: хранить значение контекста в state/ref, в провайдере при обновлении вызывать подписчиков (или использовать отдельный store с подпиской по селектору).
- Альтернатива: разбить контексты так, чтобы в каждом было одно логическое значение, тогда обычный `useContext` даёт подписку только на свой кусок.
- Для селектора можно использовать сравнение по ссылке: `Object.is(prev, next)` или кастомный компаратор.

## Критерии приёмки

- Несколько контекстов; обновление одного не ре-рендерит потребителей других.
- `useContextSelector` (или аналог): ре-рендер только при изменении выбранного значения.
- Тест: при изменении поля A ре-рендерится только компонент, подписанный на A.
